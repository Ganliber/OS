# 物理内存管理

> 非连续内存分配

[TOC]



## 非连续分配设计目标

### 连续分配缺点

* 分配给程序的物理内存必须连续
* 存在外碎片和内碎片
* 内存分配的动态修改困难
* 内存利用率低（用户应用进程的需求无法满足）



### 非连续分配的设计目标

> **提高内存利用效率和管理灵活性**

* 允许一个程序使用非连续的物理空间
* 允许共享代码和数据（如函数库）
* 支持动态加载和动态链接

### 需要解决的问题

* VA 与 PA 之间的转换的实现
  * 软件实现：灵活，开销大
  * 硬件实现：够用，开销小
* 非连续分配的硬件辅助机制
  * 如何选择非连续分配中的内存分块大小（规定最小单元，即该单元的物理内存是连续的）
    * 段式存储管理 `segmentation`
      * 单元大小较大，同一段物理地址连续，不同段可以放到不同地方
    * 页式存储管理 `paging`



## 段式存储管理



### 段地址空间

* 进程的段地址空间由多个段组成
  * 主代码段
  * 子模块代码段
  * 公用库代码段
  * 堆栈段`stack`
  * 堆数据`heap`
  * 初始化数据段
  * 符号表
  * 等等... ...
* 段式存储管理的目的
  * 更**细粒度**和**灵活**的分离与共享



### 段地址空间的不连续二维结构

> 依题



### 段访问机制

* 段的概念：

  > 段表示**访问方式**与**存储数据**等属性相同的一段地址空间



























